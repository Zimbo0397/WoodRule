/**
 * Scrollissimo
 * Javascript plugin for smooth scroll-controlled animations
 * @version 0.6.0
 * @author frux <qdinov@yandex.ru>
 * @url https:// github.com/Promo/scrollissimo
 */
!function(t,e){function i(t,e,i,n){var o,s,r=Math.min(i,n),a=Math.max(i,n),h=t,m=e;if(h>=r&&a>=h)o=h,s=Math.min(a,m);else if(a>=m&&m>=r)o=Math.max(r,h),s=Math.min(a,m);else{if(!(r>=h&&m>=a))return;o=r,s=a}return n>i?{from:o,to:s}:{from:s,to:o}}function n(t,e,i){return isNaN(i)?m.push(new h(t,e,i)):u.push(new h(t,e,i)),this}function o(t,e){m.forEach(function(e){e.render(t)}),u.forEach(function(i){e?i._smoother.smooth(f,t):i.render(t)})}function s(t){var i=isNaN(t)?e.pageYOffset:t;o(i,a.enableSmoothing),f=i}function r(t){d||(s(t),isNaN(t)&&setTimeout(s,10))}var a,h,m=[],u=[],d=!0,f=0;!function(){var t,i=["ms","moz","webkit","o"],n=i.length;if(e.requestAnimationFrame)e._rAF=e.requestAnimationFrame;else{for(t=0;n>t&&!e.requestAnimationFrame;t+=1)e._rAF=e[i[t]+"RequestAnimationFrame"]&&e[i[t]+"RequestAnimationFrame"];e._rAF||(e._rAF=function(t){return setTimeout(function(){t()},1e3/60)})}}(),h=function(t,e,i){t&&(this.params={start:e||0,duration:t.duration()||0},this.timeline=t.pause(),isNaN(i)||(this._maxSpeed=i,this._smoother=new h.Smoother(this,this._maxSpeed)))},h.prototype.getIntersection=function(t,e){return i(this.params.start,this.params.start+this.timeline.duration()*this.timeline.timeScale(),t,e)},h.prototype.render=function(t){var e=Math.round((t-this.params.start)/this.timeline.duration()*this.timeline.timeScale()*1e3)/1e3;return 0>e&&(e=0),e>1&&(e=1),this.timeline.progress(e),this},h.Smoother=function(t,e){this.status="idle",this.animateTo=0,this.maxSpeed=Number(e),this.queue=t},h.Smoother.prototype.smooth=function(t,i){var n=this.queue.getIntersection(t,i);return n?(this.animateTo=n.to,this.animateFrom=this.animateFrom||n.from,"idle"===this.status&&(this.status="busy",this.id=e._rAF(this.step.bind(this))),this):void 0},h.Smoother.prototype.step=function(){var t=this.animateTo-this.animateFrom;Math.abs(t)>this.maxSpeed?(this.queue.render(this.animateFrom+=this.maxSpeed*(t>0?1:-1)),e._rAF(this.step.bind(this))):(this.queue.render(this.animateTo),this.status="idle",this.animateFrom=this.animateTo)},t.addEventListener("DOMContentLoaded",function(){var t,i=[],n=Number(new Date);setTimeout(function(){var t=e.pageYOffset;f=t,o(t,!1),d=!1},100),a._isTouchMode?a.enableSmoothing=!1:(t=function(e){var o,s=!1;if(5===i.length&&window.removeEventListener("wheel",t),i.push(e.deltaY),Number(new Date)-n<=400){if(5===i.length){for(o=0;5>o;o++)if(Math.abs(i[o])>100){s=!0;break}a.enableSmoothing=s}}else n=Number(new Date),i=[]},window.addEventListener("wheel",t))}),a={add:n,knock:r,enableSmoothing:!0,_isTouchMode:"ontouchstart"in e,_test:{_setRenderFunc:function(t){h.prototype._render=t},_getIntersection:i}},"object"==typeof module?module.exports=a:e.Scrollissimo=a}(document,window);
